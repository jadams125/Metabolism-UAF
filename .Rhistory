mutate(
type=ordered(type, levels=c('depth','temp.water','light','discharge', "air.pressure.mbar")),
units=ordered(labels[type], unname(labels))) %>%
ggplot(aes(x=solar.time, y=value, color=type)) + geom_line() +
facet_grid(units ~ ., scale='free_y') + theme_bw() +
scale_color_discrete('variable')
pdf(file = "C:/Users/jacob/OneDrive - University of Alaska/GitHub/Metabolism-UAF/Plots/STRT_comb.2021.pdf", height= 8.5)
ggarrange(strt.plot1.21, strtPlot2.21, ncol = 1, nrow = 2)
dev.off()
library(streamMetabolizer)
library(here)
bayes_name <- mm_name(type='bayes', pool_K600='binned', err_obs_iid=TRUE, err_proc_iid=TRUE)
bayes_name
bayes_name_AppEtAL <- "b_Kb_oipi_tr_plrckm.stan"
bayes_name_AppEtAL
#MOOS
bayes_specs <- specs(bayes_name,
burnin_steps=2000, saved_steps=2000, n_cores=8, n_chains = 4,
# GPP_daily_lower = 0, ER_daily_upper = 0
)
#FRCH
FRCH.comb <- read.csv(here("outputs", "frch.comb.csv"))
data.frch.mm <- na.omit(FRCH.comb) %>%
select(solar.time, depth, DO.obs, DO.sat, temp.water, light, discharge)
library(ggpubr)
library(anytime)
library(googlesheets4)
library(ggpmisc)
library(plyr)
library(dplyr)
library(lubridate)
library(tidyverse)
library(lubridate)
library(ggplot2)
library(scales)
library(zoo)
library(xts)
library(forecast)
library(googledrive)
library(streamMetabolizer)
library(readr)
#FRCH
FRCH.comb <- read.csv(here("outputs", "frch.comb.csv"))
#FRCH
FRCH.comb <- read.csv(here("outputs", "frch.comb.csv"))
#FRCH
set.wd()
#FRCH
setwd()
#FRCH
setwd(here())
setwd()
library(ggpubr)
library(anytime)
library(googlesheets4)
library(ggpmisc)
library(plyr)
library(dplyr)
library(lubridate)
library(tidyverse)
library(lubridate)
library(ggplot2)
library(scales)
library(zoo)
library(xts)
library(forecast)
library(googledrive)
library(streamMetabolizer)
library(readr)
library(data.table)
library(streamMetabolizer)
library(here)
bayes_name <- mm_name(type='bayes', pool_K600='binned', err_obs_iid=TRUE, err_proc_iid=TRUE)
bayes_name
bayes_name_AppEtAL <- "b_Kb_oipi_tr_plrckm.stan"
bayes_name_AppEtAL
#MOOS
bayes_specs <- specs(bayes_name,
burnin_steps=2000, saved_steps=2000, n_cores=8, n_chains = 4,
# GPP_daily_lower = 0, ER_daily_upper = 0
)
#MOOS
bayes_specs <- specs(bayes_name,
burnin_steps=2000, saved_steps=2000, n_cores=8, n_chains = 4,
GPP_daily_lower = 0, ER_daily_upper = 0
)
FRCH.comb <- read.csv(here("outputs", "frch.comb.csv"))
data.frch.mm <- na.omit(FRCH.comb) %>%
select(solar.time, depth, DO.obs, DO.sat, temp.water, light, discharge)
data.frch.mm$solar.time <- as.POSIXct(data.frch.mm$solar.time, tz = "UTC")
mm.test.frch <- metab(bayes_specs, data=data.frch.mm)
library(xts)
library(forecast)
library(googledrive)
library(ggpubr)
library(anytime)
library(googlesheets4)
library(ggpmisc)
library(plyr)
library(dplyr)
library(lubridate)
library(tidyverse)
library(lubridate)
library(ggplot2)
library(scales)
library(zoo)
library(xts)
library(forecast)
library(googledrive)
library(streamMetabolizer)
library(readr)
library(here)
library(rstan)
bayes_name <- mm_name(type='bayes', pool_K600='binned', err_obs_iid=TRUE, err_proc_iid=TRUE)
bayes_name
bayes_name_AppEtAL <- "b_Kb_oipi_tr_plrckm.stan"
bayes_name_AppEtAL
bayes_specs <- specs(bayes_name,
burnin_steps=1000, saved_steps=3000, n_cores=4, n_chains = 4,
GPP_daily_lower = 0, ER_daily_upper = 0
)
#FRCH
setwd(here())
FRCH.comb <- read.csv(here("outputs", "frch.comb.csv"))
FRCH.comb <- FRCH.comb %>% filter(datetimeAK < "2019-08-01 00:00:00" & datetimeAK >= "2019-07-01 00:00:00")
data.frch.mm <- na.omit(FRCH.comb) %>%
select(solar.time, depth, DO.obs, DO.sat, temp.water, light, discharge)
data.frch.mm$solar.time <- as.POSIXct(data.frch.mm$solar.time, tz = "UTC")
mm.test.frch <- metab(bayes_specs, data=data.frch.mm)
fit.frch <- get_fit(mm.test.frch)
fit.frch
mcmc3 <- get_mcmc(mm.test.frch)
output77 <- rstan::traceplot(mcmc3, pars='K600_daily', nrow=3)
output77
output77
library(ggpubr)
library(anytime)
library(googlesheets4)
library(ggpmisc)
library(plyr)
library(dplyr)
library(lubridate)
library(tidyverse)
library(lubridate)
library(ggplot2)
library(scales)
library(zoo)
library(xts)
library(forecast)
library(googledrive)
library(streamMetabolizer)
library(readr)
library(here)
library(rstan)
bayes_name <- mm_name(type='bayes', pool_K600='binned', err_obs_iid=TRUE, err_proc_iid=TRUE)
bayes_name
bayes_name_AppEtAL <- "b_Kb_oipi_tr_plrckm.stan"
bayes_name_AppEtAL
bayes_specs <- specs(bayes_name,
burnin_steps=1000, saved_steps=9000, n_cores=4, n_chains = 4,
GPP_daily_lower = 0, ER_daily_upper = 0
)
bayes_name <- mm_name(type='bayes', pool_K600='binned', err_obs_iid=TRUE, err_proc_iid=TRUE)
bayes_name
bayes_name_AppEtAL <- "b_Kb_oipi_tr_plrckm.stan"
bayes_name_AppEtAL
bayes_specs <- specs(bayes_name,
burnin_steps=1000, saved_steps=9000, n_cores=4, n_chains = 4,
GPP_daily_lower = 0, ER_daily_upper = 0
)
#FRCH
setwd(here())
FRCH.comb <- read.csv(here("outputs", "frch.comb.csv"))
FRCH.comb <- FRCH.comb %>% filter(datetimeAK < "2019-08-01 00:00:00" & datetimeAK >= "2019-07-01 00:00:00")
data.frch.mm <- na.omit(FRCH.comb) %>%
select(solar.time, depth, DO.obs, DO.sat, temp.water, light, discharge)
data.frch.mm$solar.time <- as.POSIXct(data.frch.mm$solar.time, tz = "UTC")
mm.test.frch <- metab(bayes_specs, data=data.frch.mm)
fit.frch <- get_fit(mm.test.frch)
fit.frch
mcmc3 <- get_mcmc(mm.test.frch)
output77 <- rstan::traceplot(mcmc3, pars='K600_daily', nrow=3)
output77
library(ggpubr)
library(anytime)
library(googlesheets4)
library(ggpmisc)
library(plyr)
library(dplyr)
library(lubridate)
library(tidyverse)
library(lubridate)
library(ggplot2)
library(scales)
library(zoo)
library(xts)
library(forecast)
library(googledrive)
library(streamMetabolizer)
library(readr)
library(here)
library(rstan)
bayes_name <- mm_name(type='bayes', pool_K600='binned', err_obs_iid=TRUE, err_proc_iid=TRUE)
bayes_name
bayes_name_AppEtAL <- "b_Kb_oipi_tr_plrckm.stan"
bayes_name_AppEtAL
bayes_specs <- specs(bayes_name,
burnin_steps=1000, saved_steps=18000, n_cores=4, n_chains = 4,
GPP_daily_lower = 0, ER_daily_upper = 0
)
dat <- data_metab(num_days='3', res='15', day_start=4, day_end=28)
#FRCH
setwd(here())
FRCH.comb <- read.csv(here("outputs", "frch.comb.csv"))
FRCH.comb <- FRCH.comb %>% filter(datetimeAK < "2019-08-01 00:00:00" & datetimeAK >= "2019-07-01 00:00:00")
data.frch.mm <- na.omit(FRCH.comb) %>%
select(solar.time, depth, DO.obs, DO.sat, temp.water, light, discharge)
data.frch.mm$solar.time <- as.POSIXct(data.frch.mm$solar.time, tz = "UTC")
mm.test.frch <- metab(bayes_specs, data=data.frch.mm)
fit.frch <- get_fit(mm.test.frch)
fit.frch
mcmc3 <- get_mcmc(mm.test.frch)
output77 <- rstan::traceplot(mcmc3, pars='K600_daily', nrow=3)
output77
bayes_specs <- specs(bayes_name,
burnin_steps=1000, saved_steps=5000, n_cores=4, n_chains = 4,
GPP_daily_lower = 0, ER_daily_upper = 0
)
library(ggpubr)
library(anytime)
library(googlesheets4)
library(ggpmisc)
library(plyr)
library(dplyr)
library(lubridate)
library(tidyverse)
library(lubridate)
library(ggplot2)
library(scales)
library(zoo)
library(xts)
library(forecast)
library(googledrive)
library(streamMetabolizer)
library(readr)
library(here)
library(rstan)
bayes_name <- mm_name(type='bayes', pool_K600='binned', err_obs_iid=TRUE, err_proc_iid=TRUE)
bayes_name
bayes_name_AppEtAL <- "b_Kb_oipi_tr_plrckm.stan"
bayes_name_AppEtAL
bayes_specs <- specs(bayes_name,
burnin_steps=1000, saved_steps=5000, n_cores=4, n_chains = 4,
GPP_daily_lower = 0, ER_daily_upper = 0
)
dat <- data_metab(num_days='3', res='15', day_start=4, day_end=28)
#FRCH
setwd(here())
FRCH.comb <- read.csv(here("outputs", "frch.comb.csv"))
FRCH.comb <- FRCH.comb %>% filter(datetimeAK < "2019-08-01 00:00:00" & datetimeAK >= "2019-07-01 00:00:00")
data.frch.mm <- na.omit(FRCH.comb) %>%
select(solar.time, depth, DO.obs, DO.sat, temp.water, light, discharge)
data.frch.mm$solar.time <- as.POSIXct(data.frch.mm$solar.time, tz = "UTC")
?calc_light_merged()
?calc_light
FRCH.comb$modeledLight <- calc_light(FRCH.comb$solar.time, 64.60667379, -146.916364)
#FRCH
setwd(here())
FRCH.comb <- read.csv(here("outputs", "frch.comb.csv"))
FRCH.comb <- FRCH.comb %>% filter(datetimeAK < "2019-08-01 00:00:00" & datetimeAK >= "2019-07-01 00:00:00")
data.frch.mm <- na.omit(FRCH.comb) %>%
select(solar.time, depth, DO.obs, DO.sat, temp.water, light, discharge)
data.frch.mm$solar.time <- as.POSIXct(data.frch.mm$solar.time, tz = "UTC")
data.frch.mm$modeledLight <- calc_light(data.frch.mm$solar.time, 64.60667379, -146.916364)
?calc_light_merged
#FRCH
setwd(here())
FRCH.comb <- read.csv(here("outputs", "frch.comb.csv"))
FRCH.comb <- FRCH.comb %>% filter(datetimeAK < "2019-08-01 00:00:00" & datetimeAK >= "2019-07-01 00:00:00")
data.frch.mm <- na.omit(FRCH.comb) %>%
select(solar.time, depth, DO.obs, DO.sat, temp.water, light, discharge)
data.frch.mm$solar.time <- as.POSIXct(data.frch.mm$solar.time, tz = "UTC")
parMod <- calc_light(data.frch.mm$solar.time, 64.60667379, -146.916364)
view(parMod)
calc_light_merged( PAR.obs = data.frch.mm(solar.time, light), data.frch.mm$solar.time, 64.60667379, -146.916364)
#FRCH
setwd(here())
FRCH.comb <- read.csv(here("outputs", "frch.comb.csv"))
FRCH.comb <- FRCH.comb %>% filter(datetimeAK < "2019-08-01 00:00:00" & datetimeAK >= "2019-07-01 00:00:00")
data.frch.mm <- na.omit(FRCH.comb) %>%
select(solar.time, depth, DO.obs, DO.sat, temp.water, light, discharge)
data.frch.mm$solar.time <- as.POSIXct(data.frch.mm$solar.time, tz = "UTC")
parMod <- calc_light(data.frch.mm$solar.time, 64.60667379, -146.916364)
calc_light_merged( PAR.obs = data.frch.mm(solar.time, light), data.frch.mm$solar.time, 64.60667379, -146.916364)
calc_light_merged( PAR.obs = mm_data(data.frch.mm$solar.time, data.frch.mm$light), data.frch.mm$solar.time, 64.60667379, -146.916364)
?mm_data()
??calc_light_merged
timebounds <- as.POSIXct(c('2019-08-01 00:00:00', '2019-07-01 00:00:00'), tz='Alaska/Anchorage')
timebounds <- as.POSIXct(c('2019-08-01 00:00:00', '2019-07-01 00:00:00'), tz='Alaska')
?tz=
parMod <- calc_light(data.frch.mm$solar.time, 64.60667379, -146.916364)
?tz
timebounds <- as.POSIXct(c('2019-08-01 00:00:00', '2019-07-01 00:00:00'), tz='Alaska/Anchorage')
timebounds <- as.POSIXct(c('2019-08-01 00:00:00', '2019-07-01 00:00:00'), tz='AKST')
timebounds <- as.POSIXct(c('2019-08-01 00:00:00', '2019-07-01 00:00:00'), tz='EST')
timebounds <- as.POSIXct(c('2019-08-01 00:00:00', '2019-07-01 00:00:00'), tz='EST')
timebounds <- as.POSIXct(c('2019-08-01 00:00:00', '2019-07-01 00:00:00'), tz='AKT')
timebounds <- as.POSIXct(c('2019-08-01 00:00:00', '2019-07-01 00:00:00'), tz= "AK")
timebounds <- as.POSIXct(c('2019-08-01 00:00:00', '2019-07-01 00:00:00'), tz= "AKT")
timebounds <- as.POSIXct(c('2019-08-01 00:00:00', '2019-07-01 00:00:00'), tz= "AKST")
timebounds <- as.POSIXct(c('2019-08-01 00:00:00', '2019-07-01 00:00:00'), tz= "America/Chicago")
timebounds <- as.POSIXct(c('2019-08-01 00:00:00', '2019-07-01 00:00:00'), tz= "America/Chicago")
coords <- list(lat=32.4, lon=-96.5)
timebounds <- as.POSIXct(c('2019-08-01 00:00:00', '2019-07-01 00:00:00'), tz= "America/Anchorage")
timebounds <- as.POSIXct(c('2019-08-01 00:00:00', '2019-07-01 00:00:00'), tz= "America/Anchorage")
timebounds <- as.POSIXct(c('2019-08-01 00:00:00', '2019-07-01 00:00:00'), tz= "America/Anchorage")
timebounds <- as.POSIXct(c('2019-08-01 00:00:00', '2019-07-01 00:00:00'), tz= "America/Anchorage")
coords <- list(lat=64.60667379, lon=-146.916364)
PAR.obs <- tibble::tibble(
solar.time=seq(timebounds[1], timebounds[2], by=as.difftime(3, units='hours')),
light=data.frch.mm$light
) %>% as.data.frame()
timebounds <- as.POSIXct(c('2019-08-01 00:00:00', '2019-07-01 00:00:00'), tz= "America/Anchorage")
coords <- list(lat=64.60667379, lon=-146.916364)
PAR.obs <- tibble::tibble(
solar.time=seq(timebounds[1], timebounds[2], by=as.difftime(3, units='hours')),
light = c(data.frch.mm$light)
) %>% as.data.frame()
timebounds <- as.POSIXct(c('2019-08-01 00:00:00', '2019-07-01 00:00:00'), tz= "America/Anchorage")
coords <- list(lat=64.60667379, lon=-146.916364)
PAR.obs <- tibble::tibble(
solar.time=seq(timebounds[1], timebounds[2], by=as.difftime(15, units='minutes')),
light = c(data.frch.mm$light)
) %>% as.data.frame()
PAR.obs <- tibble::tibble(
solar.time=seq(timebounds[1], timebounds[2], by=as.difftime(15, units='minute')),
light = c(data.frch.mm$light)
) %>% as.data.frame()
??calc_light_merged
timebounds <- as.POSIXct(c('2019-08-01 00:00:00', '2019-07-01 00:00:00'), tz= "America/Anchorage")
coords <- list(lat=64.60667379, lon=-146.916364)
PAR.obs <- tibble::tibble(
solar.time=seq(timebounds[1], timebounds[2], by=as.difftime(15, units='mins')),
light = c(data.frch.mm$light)
) %>% as.data.frame()
solar.time=seq(timebounds[1], timebounds[2],
PAR.obs <- tibble::tibble(
solar.time=seq(timebounds[1], timebounds[2]),
light = c(data.frch.mm$light)
) %>% as.data.frame()
timebounds <- as.POSIXct(c('2019-08-01 00:00:00', '2019-07-01 00:00:00'), tz= "America/Anchorage")
timebounds <- as.POSIXct(c('2019-08-01 00:00:00', '2019-07-01 00:00:00'), tz= "America/Anchorage")
timebounds <- as.POSIXct(c('2019-08-01 00:00:00', '2019-07-01 00:00:00'), tz= "America/Anchorage")
coords <- list(lat=64.60667379, lon=-146.916364)
PAR.obs <- tibble::tibble(
solar.time=seq(timebounds[1], timebounds[2]),
light = c(data.frch.mm$light)
) %>% as.data.frame()
PAR.obs <- data.frch.mm %>%
select(solar.time, light)
??calc_light_merged
calc_light_merged( PAR.obs, solar.time = data.frch.mm$solar.time, 64.60667379, -146.916364)
mm.test.frch$light <- calc_light_merged( PAR.obs, solar.time = data.frch.mm$solar.time, 64.60667379, -146.916364)
#FRCH
setwd(here())
FRCH.comb <- read.csv(here("outputs", "frch.comb.csv"))
FRCH.comb <- FRCH.comb %>% filter(datetimeAK < "2019-08-01 00:00:00" & datetimeAK >= "2019-07-01 00:00:00")
data.frch.mm <- na.omit(FRCH.comb) %>%
select(solar.time, depth, DO.obs, DO.sat, temp.water, light, discharge)
data.frch.mm$solar.time <- as.POSIXct(data.frch.mm$solar.time, tz = "UTC")
parMod <- calc_light(data.frch.mm$solar.time, 64.60667379, -146.916364)
timebounds <- as.POSIXct(c('2019-08-01 00:00:00', '2019-07-01 00:00:00'), tz= "America/Anchorage")
coords <- list(lat=64.60667379, lon=-146.916364)
PAR.obs <- data.frch.mm %>%
select(solar.time, light)
calc_light_merged( PAR.obs, solar.time = data.frch.mm$solar.time, 64.60667379, -146.916364, attach.units = deprecated())
mm.test.frch$light <- calc_light_merged( PAR.obs, solar.time = data.frch.mm$solar.time, 64.60667379, -146.916364)
lightmerged <- calc_light_merged( PAR.obs, solar.time = data.frch.mm$solar.time, 64.60667379, -146.916364)
View(lightmerged)
?calc_solar_time
FRCH.comb$datetimeAK
force_tz(FRCH.comb$datetimeAK, "America/Anchorage")
calc_solar_time(as.POSIXct(FRCH.comb$datetimeAK), longitude = -146.916364)
FRCH.comb$datetimeAK <- force_tz(FRCH.comb$datetimeAK, "America/Anchorage")
force_tz(FRCH.comb$datetimeAK, "America/Anchorage")
#FRCH
setwd(here())
FRCH.comb <- read.csv(here("outputs", "frch.comb.csv"))
FRCH.comb <- FRCH.comb %>% filter(datetimeAK < "2019-08-01 00:00:00" & datetimeAK >= "2019-07-01 00:00:00")
FRCH.comb$datetimeAK <- force_tz(as.POSIXct(FRCH.comb$datetimeAK), "America/Anchorage")
FRCH.comb$solar.time <- calc_solar_time(as.POSIXct(FRCH.comb$datetimeAK), longitude = -146.916364)
data.frch.mm <- na.omit(FRCH.comb) %>%
select(solar.time, depth, DO.obs, DO.sat, temp.water, light, discharge)
data.frch.mm$solar.time <- as.POSIXct(data.frch.mm$solar.time, tz = "UTC")
parMod <- calc_light(data.frch.mm$solar.time, 64.60667379, -146.916364)
timebounds <- as.POSIXct(c('2019-08-01 00:00:00', '2019-07-01 00:00:00'), tz= "America/Anchorage")
coords <- list(lat=64.60667379, lon=-146.916364)
PAR.obs <- data.frch.mm %>%
select(solar.time, light)
lightmerged <- calc_light_merged( PAR.obs, solar.time = data.frch.mm$solar.time, 64.60667379, -146.916364)
View(lightmerged)
data.frch.mm <- merge(lightmerged, data.frch.mm, by = solar.time)
View(lightmerged)
data.frch.mm <- merge(lightmerged, data.frch.mm, by = "solar.time")
View(data.frch.mm)
#FRCH
setwd(here())
FRCH.comb <- read.csv(here("outputs", "frch.comb.csv"))
FRCH.comb <- FRCH.comb %>% filter(datetimeAK < "2019-08-01 00:00:00" & datetimeAK >= "2019-07-01 00:00:00")
FRCH.comb$datetimeAK <- force_tz(as.POSIXct(FRCH.comb$datetimeAK), "America/Anchorage")
FRCH.comb$solar.time <- calc_solar_time(as.POSIXct(FRCH.comb$datetimeAK), longitude = -146.916364)
data.frch.mm <- na.omit(FRCH.comb) %>%
select(solar.time, depth, DO.obs, DO.sat, temp.water, light, discharge)
data.frch.mm$solar.time <- as.POSIXct(data.frch.mm$solar.time, tz = "UTC")
parMod <- calc_light(data.frch.mm$solar.time, 64.60667379, -146.916364)
timebounds <- as.POSIXct(c('2019-08-01 00:00:00', '2019-07-01 00:00:00'), tz= "America/Anchorage")
coords <- list(lat=64.60667379, lon=-146.916364)
PAR.obs <- data.frch.mm %>%
select(solar.time, light)
lightmerged <- calc_light_merged( PAR.obs, solar.time = data.frch.mm$solar.time, 64.60667379, -146.916364)
data.frch.mm <- data.frch.mm %>%
dplyr::rename(light.obs = light)
data.frch.mm <- merge(lightmerged, data.frch.mm, by = "solar.time")
mm.test.frch <- metab(bayes_specs, data=data.frch.mm)
data.frch.mm <- na.omit(FRCH.comb) %>%
select(solar.time, depth, DO.obs, DO.sat, temp.water, light, discharge)
View(data.frch.mm)
#FRCH
setwd(here())
FRCH.comb <- read.csv(here("outputs", "frch.comb.csv"))
FRCH.comb <- FRCH.comb %>% filter(datetimeAK < "2019-08-01 00:00:00" & datetimeAK >= "2019-07-01 00:00:00")
FRCH.comb$datetimeAK <- force_tz(as.POSIXct(FRCH.comb$datetimeAK), "America/Anchorage")
FRCH.comb$solar.time <- calc_solar_time(as.POSIXct(FRCH.comb$datetimeAK), longitude = -146.916364)
data.frch.mm <- na.omit(FRCH.comb) %>%
select(solar.time, depth, DO.obs, DO.sat, temp.water, light, discharge)
data.frch.mm$solar.time <- as.POSIXct(data.frch.mm$solar.time, tz = "UTC")
parMod <- calc_light(data.frch.mm$solar.time, 64.60667379, -146.916364)
timebounds <- as.POSIXct(c('2019-08-01 00:00:00', '2019-07-01 00:00:00'), tz= "America/Anchorage")
coords <- list(lat=64.60667379, lon=-146.916364)
PAR.obs <- data.frch.mm %>%
select(solar.time, light)
lightmerged <- calc_light_merged( PAR.obs, solar.time = data.frch.mm$solar.time, 64.60667379, -146.916364)
data.frch.mm <- data.frch.mm %>%
dplyr::rename(light.obs = light)
data.frch.mm <- merge(lightmerged, data.frch.mm, by = "solar.time")
data.frch.mm <- na.omit(FRCH.comb) %>%
select(solar.time, depth, DO.obs, DO.sat, temp.water, light, discharge)
View(data.frch.mm)
data.frch.mm <- merge(lightmerged, data.frch.mm, by = "solar.time")
View(data.frch.mm)
data.frch.mm <- data.frch.mm %>%
dplyr::rename(light.obs = light)
#FRCH
setwd(here())
FRCH.comb <- read.csv(here("outputs", "frch.comb.csv"))
FRCH.comb <- FRCH.comb %>% filter(datetimeAK < "2019-08-01 00:00:00" & datetimeAK >= "2019-07-01 00:00:00")
FRCH.comb$datetimeAK <- force_tz(as.POSIXct(FRCH.comb$datetimeAK), "America/Anchorage")
FRCH.comb$solar.time <- calc_solar_time(as.POSIXct(FRCH.comb$datetimeAK), longitude = -146.916364)
data.frch.mm <- na.omit(FRCH.comb) %>%
select(solar.time, depth, DO.obs, DO.sat, temp.water, light, discharge)
data.frch.mm$solar.time <- as.POSIXct(data.frch.mm$solar.time, tz = "UTC")
parMod <- calc_light(data.frch.mm$solar.time, 64.60667379, -146.916364)
timebounds <- as.POSIXct(c('2019-08-01 00:00:00', '2019-07-01 00:00:00'), tz= "America/Anchorage")
coords <- list(lat=64.60667379, lon=-146.916364)
PAR.obs <- data.frch.mm %>%
select(solar.time, light)
lightmerged <- calc_light_merged( PAR.obs, solar.time = data.frch.mm$solar.time, 64.60667379, -146.916364)
data.frch.mm <- data.frch.mm %>%
dplyr::rename(light.obs = light)
View(data.frch.mm)
data.frch.mm <- merge(lightmerged, data.frch.mm, by = "solar.time")
View(data.frch.mm)
data.frch.mm <- na.omit(FRCH.comb) %>%
select(solar.time, depth, DO.obs, DO.sat, temp.water, light, discharge)
View(data.frch.mm)
write.csv(Predict.poke,"outputs/poke.metab.1921.csv", row.names = FALSE)
#FRCH
setwd(here())
FRCH.comb <- read.csv(here("outputs", "frch.comb.csv"))
FRCH.comb <- FRCH.comb %>% filter(datetimeAK < "2019-08-01 00:00:00" & datetimeAK >= "2019-07-01 00:00:00")
FRCH.comb$datetimeAK <- force_tz(as.POSIXct(FRCH.comb$datetimeAK), "America/Anchorage")
FRCH.comb$solar.time <- calc_solar_time(as.POSIXct(FRCH.comb$datetimeAK), longitude = -146.916364)
data.frch.mm <- na.omit(FRCH.comb) %>%
select(solar.time, depth, DO.obs, DO.sat, temp.water, light, discharge)
data.frch.mm$solar.time <- as.POSIXct(data.frch.mm$solar.time, tz = "UTC")
parMod <- calc_light(data.frch.mm$solar.time, 64.60667379, -146.916364)
timebounds <- as.POSIXct(c('2019-08-01 00:00:00', '2019-07-01 00:00:00'), tz= "America/Anchorage")
coords <- list(lat=64.60667379, lon=-146.916364)
PAR.obs <- data.frch.mm %>%
select(solar.time, light)
lightmerged <- calc_light_merged( PAR.obs, solar.time = data.frch.mm$solar.time, 64.60667379, -146.916364)
data.frch.mm <- data.frch.mm %>%
dplyr::rename(light.obs = light)
data.frch.mm <- merge(lightmerged, data.frch.mm, by = "solar.time")
data.frch.mm <- na.omit(data.frch.mm) %>%
select(solar.time, depth, DO.obs, DO.sat, temp.water, light, discharge)
View(data.frch.mm)
mm.test.frch <- metab(bayes_specs, data=data.frch.mm)
bayes_specs <- specs(bayes_name,
burnin_steps=500, saved_steps=500, n_cores=4, n_chains = 4,
GPP_daily_lower = 0, ER_daily_upper = 0
)
mm.test.frch <- metab(bayes_specs, data=data.frch.mm)
fit.frch <- get_fit(mm.test.frch)
fit.frch
bayes_specs <- specs(bayes_name,
burnin_steps=1000, saved_steps=9000, n_cores=4, n_chains = 4,
GPP_daily_lower = 0, ER_daily_upper = 0
)
mm.test.frch <- metab(bayes_specs, data=data.frch.mm)
fit.frch <- get_fit(mm.test.frch)
fit.frch
